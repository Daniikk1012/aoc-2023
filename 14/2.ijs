0 0$1!:2&2+/(*#-i.@#)+/"1'O'={{
    cache =. ,:y
    while. 1 do.
        y =. ([:|:@|.@}.@|:[:;@(<@('#',\:~);._1)"1@|:'#'&,)^:4 y
        i =. cache i:y
        if. i<#cache do.
            (i+((#cache)-i)|1e9-i){cache return.
        end.
        cache =. cache,y
    end.
}}];.(_2)1!:1<'input'
